{% extends 'base.html' %}

{% block head %}  
<br/>
{% endblock %}

{% block style %}
<style>
    #textcontent {
        width: 80%;
        height: auto;
        word-wrap:break-word;
        word-break:break-all;
        overflow: hidden;
        margin:5% auto
    }
    #pcontent{
        font-size:28px;
        color:darkslategrey
    }
</style>
{% endblock %}
{% block topmenucenter %}
    <div style="padding:20px">
        <a id =link_center href="{% url 'pages:home' %}">首页</a>
		<a id =link_center href="{% url 'pages:highsearch' %}">高级筛选</a>
        <a id =link_center  href="{% url 'pages:searchspot' %}">搜索景点</a> 
		<a id =link_center  href="{% url 'pages:retiregroup' %}">养老圈</a> 
    </div>
{% endblock %}

{% block contentbody %}
    <div style="margin: 0% 10% 0% 10%">
        <div style="width:100%; height:300px">
            <h4>我的->个人信息</h4>
            <table style="margin:0% 0% 0% 0%;width:100%">
                <tr align="left">
                    <td width="50%">账户:{{ my.name }}</td>
                    <td width="50%">邮箱:{{ my.email}}</td>
                </tr>
            </table>
            <p align="left">
                地址:{{ my.address }}
                <br/>
                电话:{{ my.phone }}
                <br/>
                <a  href="{% url 'pages:editmyinfo' %}">编辑</a>
            </p>
        </div>
        <div style="margin: 0% 10% 0% 10%;width:100%; height:300px; color:darkslategrey;font-size:28px;">
            <h4>我的->订单</h4>
            {% for order in order_list.all %}
            <table align="left" style="margin:0% 0% 0% 0%;width:100%" >
                <tr>
                    <td style="width:50%" align="left">养老机构：{{order.place.name}}</td>
                    <td style="width:50%" align="left">电话：{{order.place.phone}}</td>
                </tr>
                <tr>
                    <td style="width:50%" align="left">入住人姓名： order.guestname</td>
                    <td style="width:50%"  align="left">电话：{{order.phone}}</td>
                </tr>
                <tr>
                    <td style="width:50%" align="left">{{order.checkintime}}入住</td>
                    <td style="width:50%" align="left">{{order.checkouttime}}离开</td>
                </tr>
                <tr>
                    <td tyle="width:50%" align="left">费用：{{order.fee}}</td>
                    <td style="width:50%"  align="left">订单状态：<label id= "state"></label></td>
                </tr>
            </table>
            <p align="left">
                地址：{{order.place.address}}<br>
                <labe align="left"  style="color:grey;font-size:20px;"> 订单创建时间：{{order.time}}</labe>
                <button align="right" type="button" id= "cancel" onclick=cancelorder()">取消</button><br>
            </p>
            <!-- <script>
                orderstate({{order.id}});
            </script> -->
            {% endfor %}
        </div>
        <script>
            // function orderstate(id) {
            //      alert(id);
            //     var key="state"+id;
            //     document.getElementById(key).innerHTML="已完成";
            //     var ui =document.getElementById(key);
            //     ui.style.display="none";
            //     //alert("哈哈哈哈");
            //     // if({{order.state}}==0){
            //     //     document.getElementById("state").innerHTML="待商家确认";
            //     //     ui.style.display="visible";
            //     // }
            //     // else if({{order.state}}==1){
            //     //     document.getElementById("state").innerHTML="已确认";
            //     // }
            //     // else if({{order.state}}==2){
            //     //     document.getElementById("state").innerHTML="已取消";
            //     // }
            //     // else if({{order.state}}==3){
            //     //     document.getElementById("state").innerHTML="已拒绝";
            //     // }
            //     // else if({{order.state}}==4){
            //     //     document.getElementById("state").innerHTML="已完成";
            //     // }
            // }
            window.onload=function(){
            var cancelBtns = document.getElementsByTagName('button');
            var stateLabels = document.getElementsByTagName('label');
                for( var i=0; i<cancelBtns.length; i++){
                    var btn = cancelBtns[i];
                    btn.style.display="none";
                    var state=stateLabels[i];
                    state.innerText="已提交待商家确认";
                //     order={{order_list}}[i];
                //     if(order.state==0)
                //     {
                //         state.innerText="已提交待商家确认";
                //         btn.style.display="display";
                //     }
                //     else if(order.state==1)
                //         state.innerText="已确认";
                //     else if(order.state==2)
                //         state.innerText="已取消";
                //     else if(order.state==3)
                //         state.innerText="已拒绝";
                //         else if(order.state==4)
                //         state.innerText="已完成";
                 }
            }
            </script>
    </div>
{% endblock %}